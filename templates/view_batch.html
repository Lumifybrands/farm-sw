{% extends "base.html" %}

{% block title %}View Batch - Bismi Farms{% endblock %}

{% block content %}
<style>
/* Modern styling for view batch page */
.content-header {
    background: white;
    padding: 24px 32px;
    border-radius: 12px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    margin-bottom: 24px;
}

.content-header h1 {
    font-size: 24px;
    font-weight: 600;
    color: #1a202c;
    margin: 0 0 8px 0;
}

.breadcrumb {
    color: #718096;
    font-size: 14px;
}

.breadcrumb span:not(:last-child)::after {
    content: "/";
    margin: 0 8px;
    color: #cbd5e0;
}

.farm-details {
    display: grid;
    gap: 24px;
}

.detail-group {
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    padding: 24px;
}

.detail-group > label {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 18px;
    font-weight: 600;
    color: #2d3748;
    margin-bottom: 20px;
}

.detail-group > label i {
    color: #4299e1;
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 20px;
}

.info-box {
    background: #f8fafc;
    padding: 16px;
    border-radius: 8px;
    border: 1px solid #e2e8f0;
    transition: all 0.2s ease;
}

.info-box:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
}

.info-box .info-label {
    color: #64748b;
    font-size: 14px;
    margin-bottom: 4px;
}

.info-box .info-value {
    color: #1a202c;
    font-size: 16px;
    font-weight: 500;
}

.status-badge {
    display: inline-flex;
    align-items: center;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 14px;
    font-weight: 500;
}

.status-ongoing {
    background: #ebf8ff;
    color: #2b6cb0;
}

.status-closing {
    background: #fef3c7;
    color: #92400e;
}

.status-closed {
    background: #f0fdf4;
    color: #166534;
}

.badge {
    display: inline-flex;
    align-items: center;
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 500;
}

.badge-primary {
    background: #e9d5ff;
    color: #6b21a8;
}

.badge-secondary {
    background: #e2e8f0;
    color: #475569;
}

/* Financial section styling */
.financial-details {
    background: linear-gradient(to right, #f8fafc, #fff);
}

.financial-details .info-box.highlight {
    background: white;
    border: 1px solid #e2e8f0;
}

.financial-details .info-box.profit {
    background: #f0fdf4;
    border-color: #bbf7d0;
}

.financial-details .info-box.loss {
    background: #fef2f2;
    border-color: #fecaca;
}

/* Shed distribution styling */
.shed-capacities {
    display: grid;
    gap: 16px;
}

.shed-capacity {
    background: white;
    padding: 16px;
    border-radius: 8px;
    border: 1px solid #e2e8f0;
}

.shed-info {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
}

.shed-number {
    font-weight: 500;
    color: #2d3748;
}

.capacity-value {
    color: #4a5568;
}

.capacity-bar {
    height: 8px;
    background: #edf2f7;
    border-radius: 4px;
    overflow: hidden;
}

.capacity-fill {
    height: 100%;
    background: linear-gradient(to right, #4299e1, #667eea);
    border-radius: 4px;
    transition: width 0.3s ease;
}

/* Update section styling */
.update-selector {
    display: flex;
    gap: 12px;
    margin-bottom: 20px;
}

.update-selector input[type="date"] {
    padding: 8px 12px;
    border: 1px solid #e2e8f0;
    border-radius: 6px;
    font-size: 14px;
}

.latest-btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 8px 16px;
    background: #4299e1;
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
    transition: background 0.2s ease;
}

.latest-btn:hover {
    background: #3182ce;
}

.update-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
}

.update-date {
    display: flex;
    align-items: center;
    gap: 8px;
    color: #4a5568;
    font-size: 16px;
}

.update-actions {
    display: flex;
    gap: 12px;
}

.edit-update-btn, .delete-update-btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 8px 16px;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s ease;
    text-decoration: none;
}

.edit-update-btn {
    background: #ebf8ff;
    color: #2b6cb0;
    border: 1px solid #bee3f8;
}

.edit-update-btn:hover {
    background: #bee3f8;
}

.delete-update-btn {
    background: #fff5f5;
    color: #c53030;
    border: 1px solid #fed7d7;
}

.delete-update-btn:hover {
    background: #fed7d7;
}

/* Items section styling */
.items-section {
    margin-top: 24px;
    background: white;
    border-radius: 12px;
    overflow: hidden;
}

.items-header {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px 20px;
    background: #f8f9fa;
    border-bottom: 1px solid #e9ecef;
}

.items-header h3 {
    margin: 0;
    font-size: 16px;
    font-weight: 600;
    color: #2d3748;
}

.items-header i {
    color: #4299e1;
    font-size: 18px;
}

.items-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    padding: 20px;
}

.item-card {
    background: white;
    border-radius: 10px;
    border: 1px solid #e2e8f0;
    overflow: hidden;
    transition: all 0.2s ease;
}

.item-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
}

.item-header {
    padding: 12px 16px;
    background: #f8fafc;
    border-bottom: 1px solid #e2e8f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.item-name {
    font-weight: 500;
    color: #2d3748;
}

.item-category {
    font-size: 12px;
    padding: 4px 8px;
    background: #edf2f7;
    color: #4a5568;
    border-radius: 4px;
}

.item-details {
    padding: 16px;
}

.detail-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
}

.detail-row:last-child {
    margin-bottom: 0;
}

.detail-row label {
    color: #718096;
    font-size: 14px;
}

.detail-row span {
    color: #2d3748;
    font-weight: 500;
}

/* Feed specific styling */
.feed-card .item-header {
    background: #ebf7ed;
    border-bottom: 1px solid #d1e7dd;
}

.feed-card .item-name {
    color: #0f766e;
}

.feed-card .item-category {
    background: #d1fae5;
    color: #047857;
}

/* Medicine specific styling */
.medicine-card .item-header {
    background: #fff5f7;
    border-bottom: 1px solid #fbd5dd;
}

.medicine-card .item-name {
    color: #9f1239;
}

.medicine-card .item-category {
    background: #ffe4e6;
    color: #be123c;
}

/* Vaccine specific styling */
.vaccine-card .item-header {
    background: #f0f9ff;
    border-bottom: 1px solid #bae6fd;
}

.vaccine-card .item-name {
    color: #0369a1;
}

.vaccine-card .item-category {
    background: #e0f2fe;
    color: #0284c7;
}

/* Health material specific styling */
.health-material-card .item-header {
    background: #f0fdf4;
    border-bottom: 1px solid #bbf7d0;
}

.health-material-card .item-name {
    color: #166534;
}

.health-material-card .item-category {
    background: #dcfce7;
    color: #15803d;
}

/* Allocated items styling */
.allocated-items {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 16px;
    padding: 16px;
}

.allocated-item {
    background: #f8fafc;
    padding: 12px 16px;
    border-radius: 8px;
    border: 1px solid #e2e8f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.allocated-item .item-name {
    font-weight: 500;
    color: #2d3748;
}

.allocated-item .item-quantity {
    color: #4a5568;
    font-size: 14px;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
}

.allocated-item .item-quantity small {
    color: #718096;
    font-size: 12px;
    margin-top: 2px;
}

/* Notes section styling */
.notes-section {
    margin-top: 24px;
    padding: 16px;
    background: #fffbeb;
    border: 1px solid #fef3c7;
    border-radius: 8px;
}

.notes-section .notes-header {
    display: flex;
    align-items: center;
    gap: 8px;
    color: #92400e;
    font-weight: 500;
    margin-bottom: 8px;
}

.notes-section .notes-content {
    color: #78350f;
    font-size: 14px;
    line-height: 1.5;
    white-space: pre-wrap;
}

/* Empty state styling */
.empty-state {
    padding: 40px 20px;
    text-align: center;
    color: #718096;
}

.empty-state i {
    font-size: 24px;
    margin-bottom: 12px;
    opacity: 0.5;
}

.empty-state p {
    margin: 0;
    font-size: 14px;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .info-grid {
        grid-template-columns: 1fr;
    }
    
    .items-grid {
        grid-template-columns: 1fr;
    }
    
    .allocated-items {
        grid-template-columns: 1fr;
    }
    
    .update-header {
        flex-direction: column;
        gap: 16px;
        align-items: flex-start;
    }
    
    .update-actions {
        width: 100%;
    }
    
    .edit-update-btn, .delete-update-btn {
        flex: 1;
        justify-content: center;
    }
}
</style>

<div class="content-header">
    <h1>Batch Details</h1>
    <div class="breadcrumb">
        <span>Home</span> / <span>Batches</span> / <span>View Batch</span>
    </div>
</div>

<div class="farm-details">
    <div class="detail-group">
        <label><i class="fas fa-info-circle"></i> Basic Information</label>
        <div class="info-grid">
            <div class="info-box">
                <div class="info-label">Batch Number</div>
                <div class="info-value">{{ batch.batch_number }}</div>
            </div>
            <div class="info-box">
                <div class="info-label">Farm Name</div>
                <div class="info-value">{{ batch.farm.name }}</div>
            </div>
            <div class="info-box">
                <div class="info-label">Manager</div>
                <div class="info-value">
                    {% if batch.manager %}
                        {{ batch.manager.employee.name if batch.manager.employee else batch.manager.username }}
                        <span class="badge {% if batch.manager.user_type == 'senior_manager' %}badge-primary{% else %}badge-secondary{% endif %}">
                            {{ 'Senior Manager' if batch.manager.user_type == 'senior_manager' else 'Assistant Manager' }}
                        </span>
                    {% else %}
                        <span class="text-muted">No manager assigned</span>
                    {% endif %}
                </div>
            </div>
            <div class="info-box">
                <div class="info-label">Status</div>
                <div class="info-value">
                    <span class="status-badge status-{{ batch.status }}">{{ batch.status|title }}</span>
                </div>
            </div>
            <div class="info-box">
                <div class="info-label">Brand</div>
                <div class="info-value">{{ batch.brand if batch.brand else 'Not specified' }}</div>
            </div>
            <div class="info-box">
                <div class="info-label">Total Birds</div>
                <div class="info-value">{{ batch.total_birds }}</div>
            </div>
            <div class="info-box">
                <div class="info-label">Cost per Chicken</div>
                <div class="info-value">₹{{ "%.2f"|format(batch.cost_per_chicken) }}</div>
            </div>
            <div class="info-box">
                <div class="info-label">Total Cost</div>
                <div class="info-value">₹{{ "%.2f"|format(batch.cost_per_chicken * batch.total_birds) }}</div>
            </div>
            <div class="info-box">
                <div class="info-label">Available Birds</div>
                <div class="info-value">{{ batch.available_birds }}</div>
            </div>
            <div class="info-box">
                <div class="info-label">Age</div>
                <div class="info-value">{{ batch.get_age_days() }} days</div>
            </div>
            <div class="info-box">
                <div class="info-label">Mortality</div>
                <div class="info-value">{{ batch.total_mortality }}</div>
            </div>
            <div class="info-box">
                <div class="info-label">Feed Used</div>
                <div class="info-value">{{ "%.2f"|format(batch.feed_usage) }} packets</div>
            </div>
            <div class="info-box">
                <div class="info-label">Current Feed Stock</div>
                <div class="info-value">{{ "%.2f"|format(batch.feed_stock) }} packets</div>
            </div>
            <div class="info-box">
                <div class="info-label">Created On</div>
                <div class="info-value">{{ batch.created_at.strftime('%Y-%m-%d %H:%M') }}</div>
            </div>
        </div>
    </div>

    {% if batch.status == 'closed' %}
    <div class="detail-group financial-details">
        <label><i class="fas fa-chart-line"></i> Financial Summary</label>
        <div class="info-grid">
            <div class="info-box highlight">
                <div class="info-label">Total Revenue</div>
                <div class="info-value">₹{{ "%.2f"|format(batch.get_total_revenue()) }}</div>
            </div>
            <div class="info-box highlight">
                <div class="info-label">Total Expenses</div>
                <div class="info-value">₹{{ "%.2f"|format(batch.get_total_expenses()) }}</div>
            </div>
            <div class="info-box highlight {% if batch.get_total_profit() > 0 %}profit{% else %}loss{% endif %}">
                <div class="info-label">Total Profit/Loss</div>
                <div class="info-value">₹{{ "%.2f"|format(batch.get_total_profit()) }}</div>
            </div>
        </div>

        <div class="expense-breakdown">
            <h4>Expense Breakdown</h4>
            <div class="info-grid">
                <div class="info-box">
                    <div class="info-label">Chicken Cost</div>
                    <div class="info-value">₹{{ "%.2f"|format(batch.cost_per_chicken * batch.total_birds) }}</div>
                </div>
                <div class="info-box">
                    <div class="info-label">Feed Cost</div>
                    <div class="info-value">₹{{ "%.2f"|format(batch.get_feed_cost()) }}</div>
                </div>
                <div class="info-box">
                    <div class="info-label">Medicine Cost</div>
                    <div class="info-value">₹{{ "%.2f"|format(batch.get_medicine_cost()) }}</div>
                </div>
                <div class="info-box">
                    <div class="info-label">Health Materials Cost</div>
                    <div class="info-value">₹{{ "%.2f"|format(batch.get_health_materials_cost()) }}</div>
                </div>
                <div class="info-box">
                    <div class="info-label">Vaccine Cost</div>
                    <div class="info-value">₹{{ "%.2f"|format(batch.get_vaccine_cost()) }}</div>
                </div>
            </div>
        </div>

        <div class="revenue-breakdown">
            <h4>Revenue Breakdown</h4>
            <div class="info-grid">
                <div class="info-box">
                    <div class="info-label">Total Birds Harvested</div>
                    <div class="info-value">{{ batch.total_birds - batch.available_birds }}</div>
                </div>
                <div class="info-box">
                    <div class="info-label">Average Selling Price</div>
                    <div class="info-value">₹{{ "%.2f"|format(batch.get_average_selling_price()) }}</div>
                </div>
                <div class="info-box">
                    <div class="info-label">Total Weight Sold</div>
                    <div class="info-value">{{ "%.2f"|format(batch.get_total_weight_sold()) }} kg</div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <div class="detail-group">
        <label><i class="fas fa-warehouse"></i> Shed Distribution</label>
        <div class="shed-capacities">
            {% for shed_birds in batch.get_shed_birds() %}
            <div class="shed-capacity">
                <div class="shed-info">
                    <span class="shed-number">Shed {{ loop.index }}</span>
                    <span class="capacity-value">{{ shed_birds }} birds</span>
                </div>
                <div class="capacity-bar">
                    <div class="capacity-fill" style="width: {{ (shed_birds / batch.farm.get_shed_capacities()[loop.index0] * 100)|round }}%"></div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <div class="detail-group">
        <label><i class="fas fa-chart-line"></i> Daily Updates</label>
        <div class="update-selector">
            <input type="date" id="updateDate" onchange="loadUpdate()">
            <button onclick="loadLatestUpdate()" class="latest-btn">
                <i class="fas fa-sync"></i> Latest Update
            </button>
        </div>
        <div id="updateDetails" class="update-details">
            {% if batch.updates %}
                {% set last_update = batch.updates|sort(attribute='date', reverse=true)|first %}
                <div class="update-header">
                    <div class="update-date">
                        <i class="fas fa-calendar"></i>
                        <span>{{ last_update.date.strftime('%Y-%m-%d') }}</span>
                    </div>
                    <div class="update-actions">
                        <a href="/batches/{{ batch.id }}/update/{{ last_update.date.strftime('%Y-%m-%d') }}/edit" class="edit-update-btn">
                            <i class="fas fa-edit"></i> Edit
                        </a>
                        <button onclick="deleteBatchUpdate('{{ last_update.date.strftime('%Y-%m-%d') }}')" class="delete-update-btn">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
                <div class="update-content">
                    <div class="info-section">
                        <div class="info-section-title">
                            <i class="fas fa-info-circle"></i>
                            Basic Information
                        </div>
                        <div class="info-grid">
                            <div class="info-item">
                                <label>Mortality Count</label>
                                <span>{{ last_update.mortality_count }}</span>
                            </div>
                            <div class="info-item">
                                <label>Feed Used</label>
                                <span>{{ "%.2f"|format(last_update.feed_used) }} packets</span>
                            </div>
                            <div class="info-item" style="display: none;">
                                <label>Feed Allocated</label>
                                <span>
                                    {% set total_allocation = 0 %}
                                    {% for feed in last_update.feeds %}
                                        {% set total_allocation = total_allocation + last_update.get_feed_quantity(feed.id) %}
                                    {% endfor %}
                                    {{ "%.2f"|format(total_allocation) }} packets
                                </span>
                            </div>
                            <div class="info-item">
                                <label>Average Weight</label>
                                <span>{{ "%.2f"|format(last_update.avg_weight) }} kg</span>
                            </div>
                        </div>
                    </div>

                    {% if last_update.feeds %}
                    <div class="items-section">
                        <div class="items-header">
                            <i class="fas fa-drumstick-bite"></i>
                            <h3>Feed Allocation</h3>
                        </div>
                        <div class="items-grid">
                            {% for feed in last_update.feeds %}
                            <div class="item-card feed-card">
                                <div class="item-header">
                                    <span class="item-name">{{ feed.brand }}</span>
                                    <span class="item-category">{{ feed.category }}</span>
                                </div>
                                <div class="item-details">
                                    <div class="detail-row">
                                        <label>Feed Allocated</label>
                                        <span>{{ "%.2f"|format(last_update.get_feed_quantity(feed.id)) }} packets</span>
                                    </div>
                                    <div class="detail-row">
                                        <label>Weight per Packet</label>
                                        <span>{{ feed.weight }} kg</span>
                                    </div>
                                    <div class="detail-row">
                                        <label>Price per Packet</label>
                                        <span>₹{{ "%.2f"|format(feed.price) }}</span>
                                    </div>
                                    <div class="detail-row highlight">
                                        <label>Total Cost</label>
                                        <span>₹{{ "%.2f"|format(feed.price * last_update.get_feed_quantity(feed.id)) }}</span>
                                    </div>
                                    
                                    <!-- <div class="feed-stock">
                                        <div class="feed-stock-header">
                                            <i class="fas fa-warehouse"></i>
                                            Current Stock Level
                                        </div>
                                        {% set stock_percentage = (batch.feed_stock / batch.total_birds * 100)|round %}
                                        <div class="feed-progress">
                                            <div class="feed-progress-bar 
                                                {% if stock_percentage < 30 %}feed-progress-low
                                                {% elif stock_percentage < 60 %}feed-progress-medium{% endif %}"
                                                style="width: {{ stock_percentage }}%">
                                            </div>
                                        </div>
                                        <div class="feed-stats">
                                            <span>{{ "%.2f"|format(batch.feed_stock) }} packets available</span>
                                            <span>{{ stock_percentage }}% remaining</span>
                                        </div>
                                    </div> -->

                                    {% if feed.notes %}
                                    <div class="detail-row notes">
                                        <label>Notes</label>
                                        <span>{{ feed.notes }}</span>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% else %}
                    <div class="items-section">
                        <div class="no-items">
                            <i class="fas fa-box-open"></i>
                            <p>No feed allocated in this update</p>
                        </div>
                    </div>
                    {% endif %}

                    {% if last_update.medicines %}
                    <div class="items-section">
                        <div class="items-header">
                            <i class="fas fa-pills"></i>
                            <h3>Medicines Used</h3>
                        </div>
                        <div class="items-grid">
                            {% for medicine in last_update.medicines %}
                            <div class="item-card">
                                <div class="item-header">
                                <span class="item-name">{{ medicine.name }}</span>
                                    <span class="item-category">{{ medicine.unit_type }}</span>
                                </div>
                                <div class="item-details">
                                    <div class="detail-row">
                                        <label>Quantity Used</label>
                                        <span>{{ "%.2f"|format(last_update.get_medicine_quantity(medicine.id)) }} Units</span>
                                    </div>
                                    <div class="detail-row">
                                        <label>Quantity per Unit</label>
                                        <span>{{ medicine.quantity_per_unit }} {{ medicine.unit_type }}</span>
                                    </div>
                                    <div class="detail-row">
                                        <label>Price per Unit</label>
                                        <span>₹{{ "%.2f"|format(medicine.price) }}</span>
                                    </div>
                                    <div class="detail-row highlight">
                                        <label>Total Cost</label>
                                        <span>₹{{ "%.2f"|format(medicine.price * last_update.get_medicine_quantity(medicine.id)) }}</span>
                                    </div>
                                    {% if medicine.notes %}
                                    <div class="detail-row notes">
                                        <label>Notes</label>
                                        <span>{{ medicine.notes }}</span>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}

                    {% if last_update.vaccine_updates %}
                    <div class="items-section">
                        <div class="items-header">
                            <i class="fas fa-syringe"></i>
                            <h3>Vaccines Administered</h3>
                        </div>
                        <div class="items-grid">
                            {% for vaccine_update in last_update.vaccine_updates %}
                            {% set vaccine = last_update.vaccines|selectattr("id", "equalto", vaccine_update[0])|first %}
                            <div class="item-card">
                                <div class="item-header">
                                    <span class="item-name">{{ vaccine.name }}</span>
                                    <span class="dose-badge">
                                        <i class="fas fa-circle"></i>
                                        Dose {{ vaccine_update[1] }}/{{ vaccine.doses_required }}
                                    </span>
                                </div>
                                <div class="item-details">
                                    <div class="detail-row">
                                        <label>Quantity Used</label>
                                        <span>{{ "%.2f"|format(vaccine_update[2]) }} Units</span>
                                    </div>
                                    <div class="detail-row">
                                        <label>Quantity per Unit</label>
                                        <span>{{ vaccine.quantity_per_unit }} doses</span>
                                    </div>
                                    <div class="detail-row">
                                        <label>Price per Unit</label>
                                        <span>₹{{ "%.2f"|format(vaccine.price) }}</span>
                                    </div>
                                    <div class="detail-row highlight">
                                        <label>Total Cost</label>
                                        <span>₹{{ "%.2f"|format(vaccine.price * vaccine_update[2]) }}</span>
                                    </div>
                                    {% if vaccine.notes %}
                                    <div class="detail-row notes">
                                        <label>Notes</label>
                                        <span>{{ vaccine.notes }}</span>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}

                    {% if last_update.health_materials %}
                    <div class="items-section">
                        <div class="items-header">
                            <i class="fas fa-medkit"></i>
                            <h3>Health Materials Used</h3>
                        </div>
                        <div class="items-grid">
                            {% for material in last_update.health_materials %}
                            <div class="item-card">
                                <div class="item-header">
                                    <span class="item-name">{{ material.name }}</span>
                                    <span class="item-category">{{ material.category }}</span>
                                </div>
                                <div class="item-details">
                                    <div class="detail-row">
                                        <label>Quantity Used</label>
                                        <span>{{ "%.2f"|format(last_update.get_health_material_quantity(material.id)) }} Units</span>
                                    </div>
                                    <div class="detail-row">
                                        <label>Quantity per Unit</label>
                                        <span>{{ material.quantity_per_unit }} {{ material.unit_type }}</span>
                                    </div>
                                    <div class="detail-row">
                                        <label>Price per Unit</label>
                                        <span>₹{{ "%.2f"|format(material.price) }}</span>
                                    </div>
                                    <div class="detail-row highlight">
                                        <label>Total Cost</label>
                                        <span>₹{{ "%.2f"|format(material.price * last_update.get_health_material_quantity(material.id)) }}</span>
                                    </div>
                                    {% if material.notes %}
                                    <div class="detail-row notes">
                                        <label>Notes</label>
                                        <span>{{ material.notes }}</span>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% else %}
                    <div class="items-section">
                        <div class="no-items">
                            <i class="fas fa-box-open"></i>
                            <p>No health materials used in this update</p>
                        </div>
                    </div>
                    {% endif %}

                    {% if last_update.notes %}
                    <div class="info-section">
                        <div class="info-section-title">
                            <i class="fas fa-sticky-note"></i>
                            Notes
                        </div>
                        <div class="info-item">
                            <span>{{ last_update.notes }}</span>
                        </div>
                    </div>
                    {% endif %}
                </div>
            {% else %}
                <div class="no-updates">
                    <i class="fas fa-info-circle"></i>
                    <p>No updates available for this batch</p>
                </div>
            {% endif %}
        </div>
    </div>

    <div class="action-buttons">
        <a href="{{ url_for('edit_batch', batch_id=batch.id) }}" class="edit-btn">
            <i class="fas fa-edit"></i> Edit Batch
        </a>
        <button onclick="showStatusModal()" class="status-btn">
            <i class="fas fa-exchange-alt"></i> Change Status
        </button>
        <button onclick="deleteBatch({{ batch.id }})" class="delete-btn">
            <i class="fas fa-trash"></i> Delete Batch
        </button>
        <a href="{{ url_for('batches') }}" class="back-btn">
            <i class="fas fa-arrow-left"></i> Back to Batches
        </a>
    </div>
</div>

<!-- Status Change Modal -->
<div id="statusModal" class="modal">
    <div class="modal-content">
        <h2>Change Batch Status</h2>
        <div class="status-options">
            <button onclick="updateStatus('ongoing')" class="status-option {% if batch.status == 'ongoing' %}active{% endif %}">
                <i class="fas fa-play-circle"></i> Ongoing
            </button>
            <button onclick="updateStatus('closing')" class="status-option {% if batch.status == 'closing' %}active{% endif %}">
                <i class="fas fa-hourglass-half"></i> Closing
            </button>
            <button onclick="updateStatus('closed')" class="status-option {% if batch.status == 'closed' %}active{% endif %}">
                <i class="fas fa-check-circle"></i> Closed
            </button>
        </div>
        <div class="modal-actions">
            <button onclick="closeStatusModal()" class="cancel-btn">Cancel</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
function deleteBatch(batchId) {
    if (confirm('Are you sure you want to delete this batch?')) {
        fetch(`/batches/${batchId}/delete`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                window.location.href = "{{ url_for('batches') }}";
            } else {
                alert('Error deleting batch: ' + data.message);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred while deleting the batch');
        });
    }
}

function showStatusModal() {
    document.getElementById('statusModal').style.display = 'block';
}

function closeStatusModal() {
    document.getElementById('statusModal').style.display = 'none';
}

function updateStatus(newStatus) {
    fetch(`/batches/{{ batch.id }}/update-status`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ status: newStatus })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            window.location.reload();
        } else {
            alert('Error updating status: ' + data.message);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('An error occurred while updating the status');
    });
}

// Close modal when clicking outside
window.onclick = function(event) {
    const modal = document.getElementById('statusModal');
    if (event.target == modal) {
        closeStatusModal();
    }
}

function loadUpdate() {
    const date = document.getElementById('updateDate').value;
    if (!date) return;

    fetch(`/batches/{{ batch.id }}/update/${date}`)
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            if (data.success && data.update) {
                const updateDetails = document.getElementById('updateDetails');
                const formattedDate = data.update.date;
                
                let html = `
                    <div class="update-header">
                        <div class="update-date">
                            <i class="fas fa-calendar"></i>
                            <span>${formattedDate}</span>
                        </div>
                        <div class="update-actions">
                            <a href="/batches/{{ batch.id }}/update/${formattedDate}/edit" class="edit-update-btn">
                                <i class="fas fa-edit"></i> Edit
                            </a>
                            <button onclick="deleteBatchUpdate('${formattedDate}')" class="delete-update-btn">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                    <div class="update-content">
                        <div class="update-section">
                            <h3><i class="fas fa-info-circle"></i> Basic Information</h3>
                            <div class="info-grid">
                        <div class="info-item">
                            <label>Mortality Count</label>
                                    <span>${data.update.mortality_count} birds</span>
                        </div>
                        <div class="info-item">
                            <label>Feed Used</label>
                                    <span>${data.update.feed_used} kg</span>
                        </div>
                        <div class="info-item">
                                    <label>Average Weight</label>
                                    <span>${data.update.avg_weight} kg</span>
                        </div>
                        <div class="info-item">
                                    <label>Created At</label>
                                    <span>${data.update.created_at}</span>
                                </div>
                            </div>
                        </div>

                        <div class="update-section">
                            <h3><i class="fas fa-dollar-sign"></i> Cost Summary</h3>
                            <div class="info-grid">
                                <div class="info-item">
                                    <label>Feed Cost</label>
                                    <span>₹${data.update.costs.feed_cost.toFixed(2)}</span>
                                </div>
                                <div class="info-item">
                                    <label>Medicine Cost</label>
                                    <span>₹${data.update.costs.medicine_cost.toFixed(2)}</span>
                                </div>
                                <div class="info-item">
                                    <label>Health Material Cost</label>
                                    <span>₹${data.update.costs.health_material_cost.toFixed(2)}</span>
                                </div>
                                <div class="info-item">
                                    <label>Vaccine Cost</label>
                                    <span>₹${data.update.costs.vaccine_cost.toFixed(2)}</span>
                                </div>
                                <div class="info-item total-cost">
                                    <label>Total Cost</label>
                                    <span>₹${data.update.costs.total_cost.toFixed(2)}</span>
                                </div>
                            </div>
                        </div>

                        ${data.update.feeds && data.update.feeds.length > 0 ? `
                        <div class="update-section">
                            <h3><i class="fas fa-drumstick-bite"></i> Feeds</h3>
                            <div class="item-list">
                                ${data.update.feeds.map(feed => `
                                    <div class="item-card">
                                        <div class="item-header">
                                            <span class="item-name">${feed.brand}</span>
                                            <span class="item-category">${feed.category}</span>
                                        </div>
                                        <div class="item-details">
                                            <div class="detail-row">
                                                <label>Quantity:</label>
                                                <span>${feed.quantity} kg</span>
                                            </div>
                                            <div class="detail-row">
                                                <label>Weight/Unit:</label>
                                                <span>${feed.weight} kg</span>
                                            </div>
                                            <div class="detail-row">
                                                <label>Price/Unit:</label>
                                                <span>₹${feed.price}</span>
                                            </div>
                                            <div class="detail-row">
                                                <label>Total Cost:</label>
                                                <span>₹${(feed.price * feed.quantity).toFixed(2)}</span>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${data.update.medicines && data.update.medicines.length > 0 ? `
                        <div class="update-section">
                            <h3><i class="fas fa-pills"></i> Medicines</h3>
                            <div class="item-list">
                                ${data.update.medicines.map(medicine => `
                                    <div class="item-card">
                                        <div class="item-header">
                                        <span class="item-name">${medicine.name}</span>
                                            <span class="item-category">${medicine.unit_type}</span>
                                        </div>
                                        <div class="item-details">
                                            <div class="detail-row">
                                                <label>Quantity:</label>
                                                <span>${medicine.quantity} ${medicine.unit_type}</span>
                                            </div>
                                            <div class="detail-row">
                                                <label>Qty/Unit:</label>
                                                <span>${medicine.quantity_per_unit} ${medicine.unit_type}</span>
                                            </div>
                                            <div class="detail-row">
                                                <label>Price/Unit:</label>
                                                <span>₹${medicine.price}</span>
                                            </div>
                                            <div class="detail-row">
                                                <label>Total Cost:</label>
                                                <span>₹${(medicine.price * medicine.quantity).toFixed(2)}</span>
                                            </div>
                                            ${medicine.notes ? `
                                            <div class="detail-row notes">
                                                <label>Notes:</label>
                                                <span>${medicine.notes}</span>
                                            </div>
                                            ` : ''}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${data.update.health_materials && data.update.health_materials.length > 0 ? `
                        <div class="update-section">
                            <h3><i class="fas fa-first-aid"></i> Health Materials</h3>
                            <div class="item-list">
                                ${data.update.health_materials.map(material => `
                                    <div class="item-card">
                                        <div class="item-header">
                                            <span class="item-name">${material.name}</span>
                                            <span class="item-category">${material.category}</span>
                                        </div>
                                        <div class="item-details">
                                            <div class="detail-row">
                                                <label>Quantity:</label>
                                                <span>${material.quantity} ${material.unit_type}</span>
                                            </div>
                                            <div class="detail-row">
                                                <label>Qty/Unit:</label>
                                                <span>${material.quantity_per_unit} ${material.unit_type}</span>
                                            </div>
                                            <div class="detail-row">
                                                <label>Price/Unit:</label>
                                                <span>₹${material.price}</span>
                                            </div>
                                            <div class="detail-row">
                                                <label>Total Cost:</label>
                                                <span>₹${(material.price * material.quantity).toFixed(2)}</span>
                                            </div>
                                            ${material.notes ? `
                                            <div class="detail-row notes">
                                                <label>Notes:</label>
                                                <span>${material.notes}</span>
                                            </div>
                                            ` : ''}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${data.update.vaccine_updates && data.update.vaccine_updates.length > 0 ? `
                        <div class="update-section">
                            <h3><i class="fas fa-syringe"></i> Vaccines</h3>
                            <div class="item-list">
                                ${data.update.vaccine_updates.map(update => {
                                    const vaccine = data.update.vaccines.find(v => v.id === update[0]);
                                    return `
                                    <div class="item-card">
                                        <div class="item-header">
                                            <span class="item-name">${vaccine.name}</span>
                                            <span class="item-category">Dose ${update[1]}/${vaccine.doses_required}</span>
                                        </div>
                                        <div class="item-details">
                                            <div class="detail-row">
                                                <label>Quantity:</label>
                                                <span>${update[2]} doses</span>
                                            </div>
                                            <div class="detail-row">
                                                <label>Qty/Unit:</label>
                                                <span>${vaccine.quantity_per_unit} doses</span>
                                            </div>
                                            <div class="detail-row">
                                                <label>Price/Unit:</label>
                                                <span>₹${vaccine.price}</span>
                                            </div>
                                            <div class="detail-row">
                                                <label>Total Cost:</label>
                                                <span>₹${(vaccine.price * update[2]).toFixed(2)}</span>
                                            </div>
                                            <div class="detail-row">
                                                <label>Dose Ages:</label>
                                                <span>${vaccine.dose_ages.join(', ')} days</span>
                                            </div>
                                            ${vaccine.notes ? `
                                            <div class="detail-row notes">
                                                <label>Notes:</label>
                                                <span>${vaccine.notes}</span>
                                            </div>
                                            ` : ''}
                                        </div>
                                    </div>
                                `}).join('')}
                            </div>
                        </div>
                        ` : ''}

                        ${data.update.notes ? `
                        <div class="update-section">
                            <h3><i class="fas fa-sticky-note"></i> Notes</h3>
                            <div class="notes-content">
                                ${data.update.notes}
                            </div>
                        </div>
                        ` : ''}
                    </div>
                `;
                
                updateDetails.innerHTML = html;
            } else {
                document.getElementById('updateDetails').innerHTML = `
                    <div class="no-updates">
                        <i class="fas fa-info-circle"></i>
                        <p>No update found for this date.</p>
                    </div>`;
            }
        })
        .catch(error => {
            console.error('Error:', error);
            document.getElementById('updateDetails').innerHTML = `
                <div class="no-updates">
                    <i class="fas fa-exclamation-circle"></i>
                    <p>Error loading update: ${error.message}</p>
                </div>`;
        });
}

function loadLatestUpdate() {
    const today = new Date();
    document.getElementById('updateDate').value = today.toISOString().split('T')[0];
    loadUpdate();
}

function deleteBatchUpdate(date) {
    if (confirm('Are you sure you want to delete this update? This action cannot be undone.')) {
        fetch(`/batches/{{ batch.id }}/update/${date}/delete`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                location.reload();
            } else {
                alert('Error deleting update: ' + data.message);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred while deleting the update');
        });
    }
}
</script>

<style>
.status-badge {
    padding: 4px 8px;
    border-radius: 4px;
    font-weight: 500;
}

.status-ongoing {
    background-color: #e3f2fd;
    color: #1976d2;
}

.status-closing {
    background-color: #fff3e0;
    color: #f57c00;
}

.status-closed {
    background-color: #e8f5e9;
    color: #388e3c;
}

.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
}

.modal-content {
    background-color: #fefefe;
    margin: 15% auto;
    padding: 20px;
    border-radius: 8px;
    width: 80%;
    max-width: 500px;
}

.status-options {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin: 20px 0;
}

.status-option {
    padding: 12px 16px;
    border-radius: 8px;
    background: white;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 2px solid #e0e0e0;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 8px;
}

.status-option:hover {
    border-color: #2196f3;
    background-color: #f5f5f5;
}

.status-option.active {
    background-color: #e3f2fd;
    border-color: #2196f3;
    color: #1976d2;
}

.modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    margin-top: 24px;
}

.cancel-btn {
    padding: 8px 16px;
    border-radius: 6px;
    background-color: #f5f5f5;
    color: #757575;
    border: none;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s ease;
}

.cancel-btn:hover {
    background-color: #eeeeee;
}

.update-selector {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    align-items: center;
}

.update-selector input[type="date"] {
    padding: 8px 12px;
    border: 2px solid #e0e0e0;
    border-radius: 6px;
    font-size: 14px;
    transition: all 0.2s ease;
}

.update-selector input[type="date"]:focus {
    border-color: #2196f3;
    outline: none;
}

.latest-btn {
    padding: 8px 16px;
    background-color: #2196f3;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 8px;
}

.latest-btn:hover {
    background-color: #1976d2;
}

.update-details {
    background-color: #f8f9fa;
    border-radius: 8px;
    padding: 20px;
    margin-top: 10px;
}

.update-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid #e2e8f0;
}

.update-date {
    font-size: 1.1rem;
    font-weight: 500;
    color: #1a73e8;
    display: flex;
    align-items: center;
    gap: 8px;
}

.update-date i {
    font-size: 1rem;
    opacity: 0.8;
}

.update-actions {
    display: flex;
    gap: 8px;
}

.update-content {
    padding: 24px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    margin-top: 20px;
}

.update-section {
    margin-top: 20px;
    background: white;
    padding: 16px;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.update-section h4 {
    color: #2d3748;
    margin: 0 0 12px 0;
    font-size: 1rem;
    display: flex;
    align-items: center;
    gap: 8px;
}

.update-section h4 i {
    color: #4299e1;
}

.items-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 12px;
}

.item {
    background: #f8fafc;
    padding: 12px 16px;
    border-radius: 8px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: all 0.2s;
}

.item:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

.item-name {
    color: #4a5568;
    font-weight: 500;
}

.item-quantity {
    color: #2d3748;
    font-weight: 600;
    background: #edf2f7;
    padding: 6px 10px;
    border-radius: 6px;
    display: flex;
    align-items: center;
    gap: 6px;
}

.item-quantity small {
    color: #718096;
    font-weight: normal;
}

@media (max-width: 768px) {
    .update-content {
        padding: 16px;
    }

    .info-grid {
        grid-template-columns: 1fr;
    }

    .item-list {
        grid-template-columns: 1fr;
    }

    .update-header {
        flex-direction: column;
        gap: 16px;
        align-items: flex-start;
    }

    .update-actions {
        flex-direction: column;
        width: 100%;
}

    .edit-update-btn,
    .delete-update-btn {
        width: 100%;
        justify-content: center;
    }

    .update-selector {
        flex-direction: column;
        align-items: stretch;
    }

    .latest-btn {
        width: 100%;
        justify-content: center;
}

    .items-grid {
        grid-template-columns: 1fr;
    }
}

/* Action Buttons */
.action-buttons {
    display: flex;
    gap: 12px;
    margin-top: 24px;
    flex-wrap: wrap;
}

.action-buttons > * {
    flex: 1;
    min-width: 150px;
    padding: 12px 24px;
    border-radius: 8px;
    font-weight: 500;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    text-decoration: none;
    border: none;
    font-size: 14px;
}

.edit-btn {
    background-color: #2196f3;
    color: white;
}

.edit-btn:hover {
    background-color: #1976d2;
}

.status-btn {
    background-color: #ff9800;
    color: white;
}

.status-btn:hover {
    background-color: #f57c00;
}

.delete-btn {
    background-color: #f44336;
    color: white;
}

.delete-btn:hover {
    background-color: #d32f2f;
}

.back-btn {
    background-color: #757575;
    color: white;
}

.back-btn:hover {
    background-color: #616161;
}

/* Update Actions */
.update-actions {
    display: flex;
    gap: 8px;
}

.edit-update-btn, .delete-update-btn {
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    text-decoration: none;
    border: none;
}

.edit-update-btn {
    background-color: #e3f2fd;
    color: #1976d2;
}

.edit-update-btn:hover {
    background-color: #bbdefb;
}

.delete-update-btn {
    background-color: #ffebee;
    color: #d32f2f;
}

.delete-update-btn:hover {
    background-color: #ffcdd2;
}

/* Status Modal Buttons */
.status-options {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin: 20px 0;
}

.status-option {
    padding: 12px 16px;
    border-radius: 8px;
    background: white;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 2px solid #e0e0e0;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 8px;
}

.status-option:hover {
    border-color: #2196f3;
    background-color: #f5f5f5;
}

.status-option.active {
    background-color: #e3f2fd;
    border-color: #2196f3;
    color: #1976d2;
}

.modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    margin-top: 24px;
}

.cancel-btn {
    padding: 8px 16px;
    border-radius: 6px;
    background-color: #f5f5f5;
    color: #757575;
    border: none;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s ease;
}

.cancel-btn:hover {
    background-color: #eeeeee;
}

/* Latest Update Button */
.latest-btn {
    padding: 8px 16px;
    background-color: #2196f3;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 8px;
}

.latest-btn:hover {
    background-color: #1976d2;
}

/* Date Input Styling */
.update-selector input[type="date"] {
    padding: 8px 12px;
    border: 2px solid #e0e0e0;
    border-radius: 6px;
    font-size: 14px;
    transition: all 0.2s ease;
}

.update-selector input[type="date"]:focus {
    border-color: #2196f3;
    outline: none;
}

/* Responsive Design */
@media (max-width: 768px) {
    .action-buttons {
        flex-direction: column;
    }
    
    .action-buttons > * {
        width: 100%;
    }

    .update-actions {
        flex-direction: column;
        width: 100%;
    }

    .edit-update-btn, .delete-update-btn {
        width: 100%;
        justify-content: center;
    }
}

/* Items Grid Layout */
.items-section {
    margin-top: 24px;
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    overflow: hidden;
}

.items-header {
    padding: 16px 20px;
    background: #f8f9fa;
    border-bottom: 1px solid #e9ecef;
    display: flex;
    align-items: center;
    gap: 8px;
}

.items-header i {
    font-size: 18px;
}

.items-header h3 {
    margin: 0;
    font-size: 16px;
    font-weight: 600;
    color: #2d3748;
}

.items-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 16px;
    padding: 20px;
}

.item-card {
    background: white;
    border-radius: 10px;
    border: 1px solid #e2e8f0;
    transition: all 0.2s ease;
}

.item-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
}

.item-header {
    padding: 12px 16px;
    border-bottom: 1px solid #e2e8f0;
    background: #f8fafc;
    border-radius: 10px 10px 0 0;
}

.item-name {
    font-weight: 600;
    color: #2d3748;
    font-size: 15px;
    display: block;
}

.item-category {
    font-size: 13px;
    color: #718096;
    margin-top: 4px;
    display: inline-block;
}

.item-details {
    padding: 16px;
}

.detail-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    font-size: 14px;
}

.detail-row:not(:last-child) {
    border-bottom: 1px dashed #e2e8f0;
}

.detail-row label {
    color: #718096;
    font-weight: 500;
}

.detail-row span {
    color: #2d3748;
    font-weight: 500;
}

.detail-row.highlight span {
    color: #2196f3;
    font-weight: 600;
}

.detail-row.notes {
    flex-direction: column;
    gap: 8px;
    padding: 12px 0;
}

.detail-row.notes label {
    margin-bottom: 4px;
}

.detail-row.notes span {
    font-weight: normal;
    color: #4a5568;
    font-size: 13px;
    line-height: 1.5;
    background: #f8fafc;
    padding: 8px 12px;
    border-radius: 6px;
    width: 100%;
}

/* Status badges for vaccines */
.dose-badge {
    display: inline-flex;
    align-items: center;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
    background: #e3f2fd;
    color: #1976d2;
    gap: 4px;
}

.dose-badge i {
    font-size: 10px;
}

/* Empty state */
.no-items {
    padding: 40px 20px;
    text-align: center;
    color: #718096;
}

.no-items i {
    font-size: 24px;
    margin-bottom: 12px;
    opacity: 0.5;
}

.no-items p {
    margin: 0;
    font-size: 14px;
}

.no-updates {
    padding: 40px 20px;
    text-align: center;
    color: #718096;
}

.no-updates i {
    font-size: 24px;
    margin-bottom: 12px;
    opacity: 0.5;
}

.no-updates p {
    margin: 0;
    font-size: 14px;
}

@media (max-width: 768px) {
    .items-grid {
        grid-template-columns: 1fr;
        padding: 16px;
    }
    
    .item-card {
        margin-bottom: 16px;
    }
}

/* Feed specific styles */
.feed-card .item-header {
    background: #ebf7ed;
    border-bottom: 1px solid #d1e7dd;
}

.feed-card .item-name {
    color: #0f766e;
}

.feed-card .item-category {
    background: #d1fae5;
    color: #047857;
}

.feed-usage-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    margin-top: 8px;
    padding: 6px 10px;
    background: #f0fdf4;
    border-radius: 6px;
    color: #15803d;
    font-size: 13px;
    font-weight: 500;
}

.feed-usage-badge i {
    font-size: 12px;
}

.feed-stock {
    margin-top: 12px;
    padding: 12px;
    background: #f8fafc;
    border-radius: 8px;
    border: 1px dashed #e2e8f0;
}

.feed-stock-header {
    display: flex;
    align-items: center;
    gap: 6px;
    color: #64748b;
    font-size: 13px;
    font-weight: 500;
    margin-bottom: 8px;
}

.feed-progress {
    height: 6px;
    background: #e2e8f0;
    border-radius: 3px;
    overflow: hidden;
}

.feed-progress-bar {
    height: 100%;
    background: #22c55e;
    border-radius: 3px;
    transition: width 0.3s ease;
}

.feed-progress-low {
    background: #ef4444;
}

.feed-progress-medium {
    background: #f59e0b;
}

.feed-stats {
    display: flex;
    justify-content: space-between;
    margin-top: 6px;
    font-size: 12px;
    color: #64748b;
}
</style>
{% endblock %} 